<!DOCTYPE html>
<html lang="zh-hans">

<head>
    <meta charset="UTF-8">
    <title>生成HTML文章</title>
    <link rel="icon" href="/static/picture/Hive16x16.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/static/picture/Hive16x16.ico" type="image/x-icon">
</head>

<body>
    <input id="htmlTitle" placeholder="标题"></input>
    <br><br>
    <textarea id="htmlInput" rows="10" cols="50" placeholder="工具地址：https://tooltt.com/markdown2html/"></textarea><br>
    <button id="generateButton">生成</button>

    <script>
        document.getElementById('generateButton').addEventListener('click', function () {
            var htmlContent = document.getElementById('htmlInput').value.trim();
            var htmlTitle = document.getElementById('htmlTitle').value.trim();
            if (htmlContent === '' || htmlTitle === '') {
                alert('请输入 HTML 代码！');
                return;
            }

            var xhr = new XMLHttpRequest();
            xhr.open('GET', 'template.html', true);
            xhr.onreadystatechange = function () {
                if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
                    var template = xhr.responseText;
                    var finalHtml = template.replace('${title}', htmlTitle);
                    finalHtml = finalHtml.replace('${htmlContent}', htmlContent);

                    var blob = new Blob([finalHtml], { type: 'text/html' });
                    var url = URL.createObjectURL(blob);

                    var link = document.createElement('a');
                    link.href = url;

                    var timestamp = Math.round(new Date() / 1000).toString();
                    link.download = timestamp + '.html';

                    document.body.appendChild(link);
                    link.click();

                    URL.revokeObjectURL(url);
                    document.body.removeChild(link);
                }
            };
            xhr.send();
        });
    </script>
</body>

</html>